<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>E-shop T3H</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container text-align-center">
    <div class="accordion-item">
        <h2 class="accordion-header">
            <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseOne"
                    aria-expanded="true"
                    aria-controls="collapseOne"
            >
                <strong><h2>Shipping Details</h2></strong>
            </button>
        </h2>
        <div
                id="collapseOne"
                class="accordion-collapse collapse show"
                data-bs-parent="#accordionExample"
        >
            <div class="accordion-body">
                <div class="row">
                    <div class="col-8"  th:each="customer:${customer}">
                        <input
                                type="text"
                                placeholder="Enter your name"
                                class="col-4"
                                th:value="${customer.name}"
                        />

                        <input
                                type="text"
                                placeholder="Enter your email"
                                class="col-4"
                                th:value="${customer.email}"
                        />
                        <br />
                        <input
                                type="text"
                                placeholder="Enter your phone number"
                                class="col-4"
                                style="margin-top: 30px"

                        />
                        <input
                                type="text"
                                placeholder="Alternative phone no (Optional)"
                                class="col-4"
                                style="margin-top: 30px"

                        />
                        <br />
                        <input
                                type="text"
                                placeholder="House no, Building Name"
                                class="col-8"
                                style="margin-top: 30px"
                                th:value="${customer.houseNo}"
                        />
                        <br />
                        <input
                                type="text"
                                placeholder="Road, Area, Colony"
                                class="col-8"
                                style="margin-top: 30px"
                                th:value="${customer.roadArea}"
                        />
                        <br />
                        <input
                                type="text"
                                placeholder="Enter Landmark (Optional)"
                                class="col-8"
                                style="margin-top: 30px"

                        />
                        <br />
                        <div class="row">
                            <div class="col-4" style="margin-top: 30px">
                                <select class="form-select col-12" id="inputGroupSelect01">
                                    <option selected>Select Country</option>
                                    <option value="1">Việt Nam</option>
                                    <option value="2">Tung Của</option>
                                    <option value="3">Mẽo</option>
                                    <option value="3">Nga Ngố</option>
                                </select>
                            </div>
                            <div class="col-4">
                                <input
                                        type="text"
                                        placeholder="Enter State"
                                        class="col-12"
                                        style="margin-top: 30px"
                                />
                            </div>
                        </div>
                        <br />
                        <input
                                type="text"
                                placeholder="Enter District (Optional)"
                                class="col-4"
                                th:value="${customer.district}"
                        />

                        <input type="text" placeholder="Enter City" class="col-4"  th:value="${customer.city}"/>
                        <br />
                        <input
                                type="text"
                                placeholder="Enter Pincode/Zipcode"
                                class="col-4"
                                style="margin-top: 30px"
                        />
                        <br />
                        <div style="margin-top: 30px">
                            <div class="form-check form-check-inline">
                                <input
                                        class="form-check-input"
                                        type="radio"
                                        name="inlineRadioOptions"
                                        id="inlineRadio1"
                                        value="option1"
                                />
                                <label class="form-check-label" for="inlineRadio1"
                                >Home (All day delivery)
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input
                                        class="form-check-input"
                                        type="radio"
                                        name="inlineRadioOptions"
                                        id="inlineRadio2"
                                        value="option2"
                                />
                                <label class="form-check-label" for="inlineRadio2"
                                >Office (Delivery beetwen 10AM - 5PM)</label
                                >
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <button type="button" class="btn btn-dark col-4">Save</button>
                            <button type="button" class="btn btn-dark col-4">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<table class="table table-active table-success table-striped text-align-center container" border="1px" style="text-align: center;margin-top: 30px" id="cartTable">
    <tr>
        <th> Product Name</th>
        <th>Qty</th>
        <th>Selling Price</th>
    </tr>
    <tr th:each="cart : ${cart}" th:id="|cart-item-${cart.cart_id}|">
        <td th:text="${cart.title}"></td>
        <td th:text="${cart.qty}"></td>
        <td th:text="${cart.selling_price}"></td>
        <td><button class="btn btn-danger" th:onclick="deleteItem([[${cart.cart_id}]])">Delete</button></td>
    </tr>
    <tr id="totalRow">
        <td>Total</td>
        <td id="totalQty"></td>
        <td id="totalPrice"></td>
        <td><a class="btn btn-success">Pay</a></td>
    </tr>
</table>
<script th:inline="javascript">
    /*<![CDATA[*/
    // JavaScript to calculate and display totals
    window.onload = function() {
        calculateTotals();
    };

    function calculateTotals() {
        var totalQty = 0;
        var totalPrice = 0;
        var table = document.getElementById("cartTable");
        for (var i = 1; i < table.rows.length - 1; i++) {
            var row = table.rows[i];
            var qty = parseFloat(row.cells[1].innerText); // Quantity
            var price = parseFloat(row.cells[2].innerText); // Selling Price
            totalQty += qty;
            totalPrice += qty * price;
        }
        document.getElementById("totalQty").innerText = totalQty;
        document.getElementById("totalPrice").innerText = totalPrice.toFixed(2);
    }
    /*]]>*/
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function() {
        $(".btn-danger").click(function() {
            var cartId = $(this).data("cart-id");

        });

    });
    function deleteItem(cart_id){
        console.log(cart_id)
        $.ajax({
            url: "/delete?cart_id="+cart_id,
            type: "GET",
            success: function(response) {
                $("#cart-item-" + cart_id).remove();
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>